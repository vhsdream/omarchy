#!/bin/bash

export PATH="$HOME/.local/share/omarchy/bin:$PATH"
MODE="$(darkman get)"
THEMES_DIR="$HOME/.config/omarchy/themes/"
CURRENT_THEME_LINK="$HOME/.config/omarchy/current/theme"

THEMES=($(find "$THEMES_DIR" -mindepth 1 -maxdepth 1 | sort))

# Get current theme from symlink
if [[ -L "$CURRENT_THEME_LINK" ]]; then
  CURRENT_THEME=$(realpath "$CURRENT_THEME_LINK")
else
  # Default to first theme if no symlink exists
  CURRENT_THEME=$(realpath "${THEMES[0]}")
fi

# Do something here with darkman I guess?
case "$MODE" in
light)
  omarchy-theme-set rose-pine
  # gsettings set org.gnome.desktop.interface color-scheme "prefer-light"
  # gsettings set org.gnome.desktop.interface gtk-theme "Adwaita"
  ;;
dark)
  omarchy-theme-set nord
  # gsettings set org.gnome.desktop.interface color-scheme "prefer-dark"
  # gsettings set org.gnome.desktop.interface gtk-theme "Adwaita-dark"
  ;;
*)
  exit 1
  ;;
esac

NEW_MODE="$(darkman get)"
notify-send "System mode changed to $NEW_MODE" -t 2000
